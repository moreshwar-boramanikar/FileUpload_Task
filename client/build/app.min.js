/*!
	Papa Parse
	v4.3.7
	https://github.com/mholt/PapaParse
	License: MIT
*/
!function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof module&&"undefined"!=typeof exports?module.exports=b():a.Papa=b()}(this,function(){"use strict";function a(a,b){b=b||{};var c=b.dynamicTyping||!1;if(r(c)&&(b.dynamicTypingFunction=c,c={}),b.dynamicTyping=c,b.worker&&z.WORKERS_SUPPORTED){var h=k();return h.userStep=b.step,h.userChunk=b.chunk,h.userComplete=b.complete,h.userError=b.error,b.step=r(b.step),b.chunk=r(b.chunk),b.complete=r(b.complete),b.error=r(b.error),delete b.worker,void h.postMessage({input:a,config:b,workerId:h.id})}var i=null;return"string"==typeof a?i=b.download?new d(b):new f(b):a.readable===!0&&r(a.read)&&r(a.on)?i=new g(b):(t.File&&a instanceof File||a instanceof Object)&&(i=new e(b)),i.stream(a)}function b(a,b){function c(){"object"==typeof b&&("string"==typeof b.delimiter&&1===b.delimiter.length&&z.BAD_DELIMITERS.indexOf(b.delimiter)===-1&&(j=b.delimiter),("boolean"==typeof b.quotes||b.quotes instanceof Array)&&(h=b.quotes),"string"==typeof b.newline&&(k=b.newline),"string"==typeof b.quoteChar&&(l=b.quoteChar),"boolean"==typeof b.header&&(i=b.header))}function d(a){if("object"!=typeof a)return[];var b=[];for(var c in a)b.push(c);return b}function e(a,b){var c="";"string"==typeof a&&(a=JSON.parse(a)),"string"==typeof b&&(b=JSON.parse(b));var d=a instanceof Array&&a.length>0,e=!(b[0]instanceof Array);if(d&&i){for(var g=0;g<a.length;g++)g>0&&(c+=j),c+=f(a[g],g);b.length>0&&(c+=k)}for(var h=0;h<b.length;h++){for(var l=d?a.length:b[h].length,m=0;m<l;m++){m>0&&(c+=j);var n=d&&e?a[m]:m;c+=f(b[h][n],m)}h<b.length-1&&(c+=k)}return c}function f(a,b){if("undefined"==typeof a||null===a)return"";a=a.toString().replace(m,l+l);var c="boolean"==typeof h&&h||h instanceof Array&&h[b]||g(a,z.BAD_DELIMITERS)||a.indexOf(j)>-1||" "===a.charAt(0)||" "===a.charAt(a.length-1);return c?l+a+l:a}function g(a,b){for(var c=0;c<b.length;c++)if(a.indexOf(b[c])>-1)return!0;return!1}var h=!1,i=!0,j=",",k="\r\n",l='"';c();var m=new RegExp(l,"g");if("string"==typeof a&&(a=JSON.parse(a)),a instanceof Array){if(!a.length||a[0]instanceof Array)return e(null,a);if("object"==typeof a[0])return e(d(a[0]),a)}else if("object"==typeof a)return"string"==typeof a.data&&(a.data=JSON.parse(a.data)),a.data instanceof Array&&(a.fields||(a.fields=a.meta&&a.meta.fields),a.fields||(a.fields=a.data[0]instanceof Array?a.fields:d(a.data[0])),a.data[0]instanceof Array||"object"==typeof a.data[0]||(a.data=[a.data])),e(a.fields||[],a.data||[]);throw"exception: Unable to serialize unrecognized input"}function c(a){function b(a){var b=p(a);b.chunkSize=parseInt(b.chunkSize),a.step||a.chunk||(b.chunkSize=null),this._handle=new h(b),this._handle.streamer=this,this._config=b}this._handle=null,this._paused=!1,this._finished=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},b.call(this,a),this.parseChunk=function(a){if(this.isFirstChunk&&r(this._config.beforeFirstChunk)){var b=this._config.beforeFirstChunk(a);void 0!==b&&(a=b)}this.isFirstChunk=!1;var c=this._partialLine+a;this._partialLine="";var d=this._handle.parse(c,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var e=d.meta.cursor;this._finished||(this._partialLine=c.substring(e-this._baseIndex),this._baseIndex=e),d&&d.data&&(this._rowCount+=d.data.length);var f=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(v)t.postMessage({results:d,workerId:z.WORKER_ID,finished:f});else if(r(this._config.chunk)){if(this._config.chunk(d,this._handle),this._paused)return;d=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(d.data),this._completeResults.errors=this._completeResults.errors.concat(d.errors),this._completeResults.meta=d.meta),!f||!r(this._config.complete)||d&&d.meta.aborted||this._config.complete(this._completeResults,this._input),f||d&&d.meta.paused||this._nextChunk(),d}},this._sendError=function(a){r(this._config.error)?this._config.error(a):v&&this._config.error&&t.postMessage({workerId:z.WORKER_ID,error:a,finished:!1})}}function d(a){function b(a){var b=a.getResponseHeader("Content-Range");return null===b?-1:parseInt(b.substr(b.lastIndexOf("/")+1))}a=a||{},a.chunkSize||(a.chunkSize=z.RemoteChunkSize),c.call(this,a);var d;u?this._nextChunk=function(){this._readChunk(),this._chunkLoaded()}:this._nextChunk=function(){this._readChunk()},this.stream=function(a){this._input=a,this._nextChunk()},this._readChunk=function(){if(this._finished)return void this._chunkLoaded();if(d=new XMLHttpRequest,this._config.withCredentials&&(d.withCredentials=this._config.withCredentials),u||(d.onload=q(this._chunkLoaded,this),d.onerror=q(this._chunkError,this)),d.open("GET",this._input,!u),this._config.downloadRequestHeaders){var a=this._config.downloadRequestHeaders;for(var b in a)d.setRequestHeader(b,a[b])}if(this._config.chunkSize){var c=this._start+this._config.chunkSize-1;d.setRequestHeader("Range","bytes="+this._start+"-"+c),d.setRequestHeader("If-None-Match","webkit-no-cache")}try{d.send()}catch(a){this._chunkError(a.message)}u&&0===d.status?this._chunkError():this._start+=this._config.chunkSize},this._chunkLoaded=function(){if(4==d.readyState){if(d.status<200||d.status>=400)return void this._chunkError();this._finished=!this._config.chunkSize||this._start>b(d),this.parseChunk(d.responseText)}},this._chunkError=function(a){var b=d.statusText||a;this._sendError(b)}}function e(a){a=a||{},a.chunkSize||(a.chunkSize=z.LocalChunkSize),c.call(this,a);var b,d,e="undefined"!=typeof FileReader;this.stream=function(a){this._input=a,d=a.slice||a.webkitSlice||a.mozSlice,e?(b=new FileReader,b.onload=q(this._chunkLoaded,this),b.onerror=q(this._chunkError,this)):b=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var a=this._input;if(this._config.chunkSize){var c=Math.min(this._start+this._config.chunkSize,this._input.size);a=d.call(a,this._start,c)}var f=b.readAsText(a,this._config.encoding);e||this._chunkLoaded({target:{result:f}})},this._chunkLoaded=function(a){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(a.target.result)},this._chunkError=function(){this._sendError(b.error.message)}}function f(a){a=a||{},c.call(this,a);var b,d;this.stream=function(a){return b=a,d=a,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var a=this._config.chunkSize,b=a?d.substr(0,a):d;return d=a?d.substr(a):"",this._finished=!d,this.parseChunk(b)}}}function g(a){a=a||{},c.call(this,a);var b=[],d=!0;this.stream=function(a){this._input=a,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._nextChunk=function(){b.length?this.parseChunk(b.shift()):d=!0},this._streamData=q(function(a){try{b.push("string"==typeof a?a:a.toString(this._config.encoding)),d&&(d=!1,this.parseChunk(b.shift()))}catch(a){this._streamError(a)}},this),this._streamError=q(function(a){this._streamCleanUp(),this._sendError(a.message)},this),this._streamEnd=q(function(){this._streamCleanUp(),this._finished=!0,this._streamData("")},this),this._streamCleanUp=q(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function h(a){function b(){if(x&&o&&(l("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+z.DefaultDelimiter+"'"),o=!1),a.skipEmptyLines)for(var b=0;b<x.data.length;b++)1===x.data[b].length&&""===x.data[b][0]&&x.data.splice(b--,1);return c()&&d(),g()}function c(){return a.header&&0===w.length}function d(){if(x){for(var a=0;c()&&a<x.data.length;a++)for(var b=0;b<x.data[a].length;b++)w.push(x.data[a][b]);x.data.splice(0,1)}}function e(b){return a.dynamicTypingFunction&&void 0===a.dynamicTyping[b]&&(a.dynamicTyping[b]=a.dynamicTypingFunction(b)),(a.dynamicTyping[b]||a.dynamicTyping)===!0}function f(a,b){return e(a)?"true"===b||"TRUE"===b||"false"!==b&&"FALSE"!==b&&k(b):b}function g(){if(!x||!a.header&&!a.dynamicTyping)return x;for(var b=0;b<x.data.length;b++){for(var c=a.header?{}:[],d=0;d<x.data[b].length;d++){var e=d,g=x.data[b][d];a.header&&(e=d>=w.length?"__parsed_extra":w[d]),g=f(e,g),"__parsed_extra"===e?(c[e]=c[e]||[],c[e].push(g)):c[e]=g}x.data[b]=c,a.header&&(d>w.length?l("FieldMismatch","TooManyFields","Too many fields: expected "+w.length+" fields but parsed "+d,b):d<w.length&&l("FieldMismatch","TooFewFields","Too few fields: expected "+w.length+" fields but parsed "+d,b))}return a.header&&x.meta&&(x.meta.fields=w),x}function h(b,c,d){for(var e,f,g,h=[",","\t","|",";",z.RECORD_SEP,z.UNIT_SEP],j=0;j<h.length;j++){var k=h[j],l=0,m=0,n=0;g=void 0;for(var o=new i({delimiter:k,newline:c,preview:10}).parse(b),p=0;p<o.data.length;p++)if(d&&1===o.data[p].length&&0===o.data[p][0].length)n++;else{var q=o.data[p].length;m+=q,"undefined"!=typeof g?q>1&&(l+=Math.abs(q-g),g=q):g=q}o.data.length>0&&(m/=o.data.length-n),("undefined"==typeof f||l<f)&&m>1.99&&(f=l,e=k)}return a.delimiter=e,{successful:!!e,bestDelimiter:e}}function j(a){a=a.substr(0,1048576);var b=a.split("\r"),c=a.split("\n"),d=c.length>1&&c[0].length<b[0].length;if(1===b.length||d)return"\n";for(var e=0,f=0;f<b.length;f++)"\n"===b[f][0]&&e++;return e>=b.length/2?"\r\n":"\r"}function k(a){var b=q.test(a);return b?parseFloat(a):a}function l(a,b,c,d){x.errors.push({type:a,code:b,message:c,row:d})}var m,n,o,q=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,s=this,t=0,u=!1,v=!1,w=[],x={data:[],errors:[],meta:{}};if(r(a.step)){var y=a.step;a.step=function(d){if(x=d,c())b();else{if(b(),0===x.data.length)return;t+=d.data.length,a.preview&&t>a.preview?n.abort():y(x,s)}}}this.parse=function(c,d,e){if(a.newline||(a.newline=j(c)),o=!1,a.delimiter)r(a.delimiter)&&(a.delimiter=a.delimiter(c),x.meta.delimiter=a.delimiter);else{var f=h(c,a.newline,a.skipEmptyLines);f.successful?a.delimiter=f.bestDelimiter:(o=!0,a.delimiter=z.DefaultDelimiter),x.meta.delimiter=a.delimiter}var g=p(a);return a.preview&&a.header&&g.preview++,m=c,n=new i(g),x=n.parse(m,d,e),b(),u?{meta:{paused:!0}}:x||{meta:{paused:!1}}},this.paused=function(){return u},this.pause=function(){u=!0,n.abort(),m=m.substr(n.getCharIndex())},this.resume=function(){u=!1,s.streamer.parseChunk(m)},this.aborted=function(){return v},this.abort=function(){v=!0,n.abort(),x.meta.aborted=!0,r(a.complete)&&a.complete(x),m=""}}function i(a){a=a||{};var b=a.delimiter,c=a.newline,d=a.comments,e=a.step,f=a.preview,g=a.fastMode;if(void 0===a.quoteChar)var h='"';else var h=a.quoteChar;if(("string"!=typeof b||z.BAD_DELIMITERS.indexOf(b)>-1)&&(b=","),d===b)throw"Comment character same as delimiter";d===!0?d="#":("string"!=typeof d||z.BAD_DELIMITERS.indexOf(d)>-1)&&(d=!1),"\n"!=c&&"\r"!=c&&"\r\n"!=c&&(c="\n");var i=0,j=!1;this.parse=function(a,k,l){function m(a){x.push(a),A=i}function n(b){return l?p():("undefined"==typeof b&&(b=a.substr(i)),z.push(b),i=s,m(z),w&&q(),p())}function o(b){i=b,m(z),z=[],E=a.indexOf(c,i)}function p(a){return{data:x,errors:y,meta:{delimiter:b,linebreak:c,aborted:j,truncated:!!a,cursor:A+(k||0)}}}function q(){e(p()),x=[],y=[]}if("string"!=typeof a)throw"Input must be a string";var s=a.length,t=b.length,u=c.length,v=d.length,w=r(e);i=0;var x=[],y=[],z=[],A=0;if(!a)return p();if(g||g!==!1&&a.indexOf(h)===-1){for(var B=a.split(c),C=0;C<B.length;C++){var z=B[C];if(i+=z.length,C!==B.length-1)i+=c.length;else if(l)return p();if(!d||z.substr(0,v)!==d){if(w){if(x=[],m(z.split(b)),q(),j)return p()}else m(z.split(b));if(f&&C>=f)return x=x.slice(0,f),p(!0)}}return p()}for(var D=a.indexOf(b,i),E=a.indexOf(c,i),F=new RegExp(h+h,"g");;)if(a[i]!==h)if(d&&0===z.length&&a.substr(i,v)===d){if(E===-1)return p();i=E+u,E=a.indexOf(c,i),D=a.indexOf(b,i)}else if(D!==-1&&(D<E||E===-1))z.push(a.substring(i,D)),i=D+t,D=a.indexOf(b,i);else{if(E===-1)break;if(z.push(a.substring(i,E)),o(E+u),w&&(q(),j))return p();if(f&&x.length>=f)return p(!0)}else{var G=i;for(i++;;){var G=a.indexOf(h,G+1);if(G===-1)return l||y.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:x.length,index:i}),n();if(G===s-1){var H=a.substring(i,G).replace(F,h);return n(H)}if(a[G+1]!==h){if(a[G+1]===b){z.push(a.substring(i,G).replace(F,h)),i=G+1+t,D=a.indexOf(b,i),E=a.indexOf(c,i);break}if(a.substr(G+1,u)===c){if(z.push(a.substring(i,G).replace(F,h)),o(G+1+u),D=a.indexOf(b,i),w&&(q(),j))return p();if(f&&x.length>=f)return p(!0);break}y.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:x.length,index:i}),G++}else G++}}return n()},this.abort=function(){j=!0},this.getCharIndex=function(){return i}}function j(){var a=document.getElementsByTagName("script");return a.length?a[a.length-1].src:""}function k(){if(!z.WORKERS_SUPPORTED)return!1;if(!w&&null===z.SCRIPT_PATH)throw new Error("Script path cannot be determined automatically when Papa Parse is loaded asynchronously. You need to set Papa.SCRIPT_PATH manually.");var a=z.SCRIPT_PATH||s;a+=(a.indexOf("?")!==-1?"&":"?")+"papaworker";var b=new t.Worker(a);return b.onmessage=l,b.id=y++,x[b.id]=b,b}function l(a){var b=a.data,c=x[b.workerId],d=!1;if(b.error)c.userError(b.error,b.file);else if(b.results&&b.results.data){var e=function(){d=!0,m(b.workerId,{data:[],errors:[],meta:{aborted:!0}})},f={abort:e,pause:n,resume:n};if(r(c.userStep)){for(var g=0;g<b.results.data.length&&(c.userStep({data:[b.results.data[g]],errors:b.results.errors,meta:b.results.meta},f),!d);g++);delete b.results}else r(c.userChunk)&&(c.userChunk(b.results,f,b.file),delete b.results)}b.finished&&!d&&m(b.workerId,b.results)}function m(a,b){var c=x[a];r(c.userComplete)&&c.userComplete(b),c.terminate(),delete x[a]}function n(){throw"Not implemented."}function o(a){var b=a.data;if("undefined"==typeof z.WORKER_ID&&b&&(z.WORKER_ID=b.workerId),"string"==typeof b.input)t.postMessage({workerId:z.WORKER_ID,results:z.parse(b.input,b.config),finished:!0});else if(t.File&&b.input instanceof File||b.input instanceof Object){var c=z.parse(b.input,b.config);c&&t.postMessage({workerId:z.WORKER_ID,results:c,finished:!0})}}function p(a){if("object"!=typeof a)return a;var b=a instanceof Array?[]:{};for(var c in a)b[c]=p(a[c]);return b}function q(a,b){return function(){a.apply(b,arguments)}}function r(a){return"function"==typeof a}var s,t=function(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof t?t:{}}(),u=!t.document&&!!t.postMessage,v=u&&/(\?|&)papaworker(=|&|$)/.test(t.location.search),w=!1,x={},y=0,z={};if(z.parse=a,z.unparse=b,z.RECORD_SEP=String.fromCharCode(30),z.UNIT_SEP=String.fromCharCode(31),z.BYTE_ORDER_MARK="\ufeff",z.BAD_DELIMITERS=["\r","\n",'"',z.BYTE_ORDER_MARK],z.WORKERS_SUPPORTED=!u&&!!t.Worker,z.SCRIPT_PATH=null,z.LocalChunkSize=10485760,z.RemoteChunkSize=5242880,z.DefaultDelimiter=",",z.Parser=i,z.ParserHandle=h,z.NetworkStreamer=d,z.FileStreamer=e,z.StringStreamer=f,z.ReadableStreamStreamer=g,t.jQuery){var A=t.jQuery;A.fn.parse=function(a){function b(){if(0===f.length)return void(r(a.complete)&&a.complete());var b=f[0];if(r(a.before)){var e=a.before(b.file,b.inputElem);if("object"==typeof e){if("abort"===e.action)return void c("AbortError",b.file,b.inputElem,e.reason);if("skip"===e.action)return void d();"object"==typeof e.config&&(b.instanceConfig=A.extend(b.instanceConfig,e.config))}else if("skip"===e)return void d()}var g=b.instanceConfig.complete;b.instanceConfig.complete=function(a){r(g)&&g(a,b.file,b.inputElem),d()},z.parse(b.file,b.instanceConfig)}function c(b,c,d,e){r(a.error)&&a.error({name:b},c,d,e)}function d(){f.splice(0,1),b()}var e=a.config||{},f=[];return this.each(function(a){var b="INPUT"===A(this).prop("tagName").toUpperCase()&&"file"===A(this).attr("type").toLowerCase()&&t.FileReader;if(!b||!this.files||0===this.files.length)return!0;for(var c=0;c<this.files.length;c++)f.push({file:this.files[c],inputElem:this,instanceConfig:A.extend({},e)})}),b(),this}}return v?t.onmessage=o:z.WORKERS_SUPPORTED&&(s=j(),document.body?document.addEventListener("DOMContentLoaded",function(){w=!0},!0):w=!0),d.prototype=Object.create(c.prototype),d.prototype.constructor=d,e.prototype=Object.create(c.prototype),e.prototype.constructor=e,f.prototype=Object.create(f.prototype),f.prototype.constructor=f,g.prototype=Object.create(c.prototype),g.prototype.constructor=g,z});
var app = angular.module("fileupload", ['ui.router', 'ui.bootstrap']);

app.config(function($stateProvider,$urlRouterProvider) {

    $stateProvider.state({
        name: 'home',
        url: '/',
        templateUrl: 'views/home.html'
    });
    $stateProvider.state({
        name: 'fileUpload',
        url: '/fileUpload',
        controller:"fileUploadController",
        templateUrl: 'views/fileUpload.html',
    });
});
app.controller("fileUploadController",function($scope,$timeout,$uibModal){
    
    var _this = this;
    _this.showUploadBtn = false;
    _this.showProgressBar = false;
   
    var jsonObj = [];
    //function to accept csv file
    $scope.parseCsvFile = function(evt){
        $scope.$apply(function() {
            _this.showProgressBar = true;
        });
        var elem = angular.element(document.getElementById("progressbar"));
        var files = evt.files[0];
        _this.fileName = files.name;
        
        var readCsv = new FileReader();
        var rowCount = 0;    
        //reads the file onload & pass one by one records to parseJSON() to for JSON object of each record
        readCsv.onload = function(event) {    
            const record = this.result.split('\n').length;
            Papa.parse(files, {
                header: true,
                worker:true,
                step: function(results) {
                    $timeout( function(){
                        jsonObj.push(results.data[0]);
                        // console.log(jsonObj);
                        var per = Math.round((rowCount++)/record*100);
                        elem[0].style.width = per + '%'; 
                        elem[0].innerHTML = per + '%';
                        if(per == 100)
                        {
                            _this.showUploadBtn = true;
                        }
                    }, 500);
                }
            });
        }
        readCsv.readAsText(files);
    }
});

app.directive('modal', function () {
    return {
        restrict: 'E',
        scope: { 
            fileName:'=fileName',
            handler: '=id'
        },
        templateUrl: '../views/showModal.html',
        transclude: true,
        controller: function ($scope,$timeout) {
            $scope.handler = 'modal'; 
            $scope.showMsg =false;
            $timeout( function(){
                $scope.showMsg = true;
            },8000 );
        },
    };
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBhcGFQYXJzZS5qcyIsInJvdXRlcy5qcyIsImNvbnRyb2xsZXJzL2ZpbGVVcGxvYWRDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNmQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyohXHJcblx0UGFwYSBQYXJzZVxyXG5cdHY0LjMuN1xyXG5cdGh0dHBzOi8vZ2l0aHViLmNvbS9taG9sdC9QYXBhUGFyc2VcclxuXHRMaWNlbnNlOiBNSVRcclxuKi9cclxuIWZ1bmN0aW9uKGEsYil7XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShbXSxiKTpcIm9iamVjdFwiPT10eXBlb2YgbW9kdWxlJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1iKCk6YS5QYXBhPWIoKX0odGhpcyxmdW5jdGlvbigpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIGEoYSxiKXtiPWJ8fHt9O3ZhciBjPWIuZHluYW1pY1R5cGluZ3x8ITE7aWYocihjKSYmKGIuZHluYW1pY1R5cGluZ0Z1bmN0aW9uPWMsYz17fSksYi5keW5hbWljVHlwaW5nPWMsYi53b3JrZXImJnouV09SS0VSU19TVVBQT1JURUQpe3ZhciBoPWsoKTtyZXR1cm4gaC51c2VyU3RlcD1iLnN0ZXAsaC51c2VyQ2h1bms9Yi5jaHVuayxoLnVzZXJDb21wbGV0ZT1iLmNvbXBsZXRlLGgudXNlckVycm9yPWIuZXJyb3IsYi5zdGVwPXIoYi5zdGVwKSxiLmNodW5rPXIoYi5jaHVuayksYi5jb21wbGV0ZT1yKGIuY29tcGxldGUpLGIuZXJyb3I9cihiLmVycm9yKSxkZWxldGUgYi53b3JrZXIsdm9pZCBoLnBvc3RNZXNzYWdlKHtpbnB1dDphLGNvbmZpZzpiLHdvcmtlcklkOmguaWR9KX12YXIgaT1udWxsO3JldHVyblwic3RyaW5nXCI9PXR5cGVvZiBhP2k9Yi5kb3dubG9hZD9uZXcgZChiKTpuZXcgZihiKTphLnJlYWRhYmxlPT09ITAmJnIoYS5yZWFkKSYmcihhLm9uKT9pPW5ldyBnKGIpOih0LkZpbGUmJmEgaW5zdGFuY2VvZiBGaWxlfHxhIGluc3RhbmNlb2YgT2JqZWN0KSYmKGk9bmV3IGUoYikpLGkuc3RyZWFtKGEpfWZ1bmN0aW9uIGIoYSxiKXtmdW5jdGlvbiBjKCl7XCJvYmplY3RcIj09dHlwZW9mIGImJihcInN0cmluZ1wiPT10eXBlb2YgYi5kZWxpbWl0ZXImJjE9PT1iLmRlbGltaXRlci5sZW5ndGgmJnouQkFEX0RFTElNSVRFUlMuaW5kZXhPZihiLmRlbGltaXRlcik9PT0tMSYmKGo9Yi5kZWxpbWl0ZXIpLChcImJvb2xlYW5cIj09dHlwZW9mIGIucXVvdGVzfHxiLnF1b3RlcyBpbnN0YW5jZW9mIEFycmF5KSYmKGg9Yi5xdW90ZXMpLFwic3RyaW5nXCI9PXR5cGVvZiBiLm5ld2xpbmUmJihrPWIubmV3bGluZSksXCJzdHJpbmdcIj09dHlwZW9mIGIucXVvdGVDaGFyJiYobD1iLnF1b3RlQ2hhciksXCJib29sZWFuXCI9PXR5cGVvZiBiLmhlYWRlciYmKGk9Yi5oZWFkZXIpKX1mdW5jdGlvbiBkKGEpe2lmKFwib2JqZWN0XCIhPXR5cGVvZiBhKXJldHVybltdO3ZhciBiPVtdO2Zvcih2YXIgYyBpbiBhKWIucHVzaChjKTtyZXR1cm4gYn1mdW5jdGlvbiBlKGEsYil7dmFyIGM9XCJcIjtcInN0cmluZ1wiPT10eXBlb2YgYSYmKGE9SlNPTi5wYXJzZShhKSksXCJzdHJpbmdcIj09dHlwZW9mIGImJihiPUpTT04ucGFyc2UoYikpO3ZhciBkPWEgaW5zdGFuY2VvZiBBcnJheSYmYS5sZW5ndGg+MCxlPSEoYlswXWluc3RhbmNlb2YgQXJyYXkpO2lmKGQmJmkpe2Zvcih2YXIgZz0wO2c8YS5sZW5ndGg7ZysrKWc+MCYmKGMrPWopLGMrPWYoYVtnXSxnKTtiLmxlbmd0aD4wJiYoYys9ayl9Zm9yKHZhciBoPTA7aDxiLmxlbmd0aDtoKyspe2Zvcih2YXIgbD1kP2EubGVuZ3RoOmJbaF0ubGVuZ3RoLG09MDttPGw7bSsrKXttPjAmJihjKz1qKTt2YXIgbj1kJiZlP2FbbV06bTtjKz1mKGJbaF1bbl0sbSl9aDxiLmxlbmd0aC0xJiYoYys9ayl9cmV0dXJuIGN9ZnVuY3Rpb24gZihhLGIpe2lmKFwidW5kZWZpbmVkXCI9PXR5cGVvZiBhfHxudWxsPT09YSlyZXR1cm5cIlwiO2E9YS50b1N0cmluZygpLnJlcGxhY2UobSxsK2wpO3ZhciBjPVwiYm9vbGVhblwiPT10eXBlb2YgaCYmaHx8aCBpbnN0YW5jZW9mIEFycmF5JiZoW2JdfHxnKGEsei5CQURfREVMSU1JVEVSUyl8fGEuaW5kZXhPZihqKT4tMXx8XCIgXCI9PT1hLmNoYXJBdCgwKXx8XCIgXCI9PT1hLmNoYXJBdChhLmxlbmd0aC0xKTtyZXR1cm4gYz9sK2ErbDphfWZ1bmN0aW9uIGcoYSxiKXtmb3IodmFyIGM9MDtjPGIubGVuZ3RoO2MrKylpZihhLmluZGV4T2YoYltjXSk+LTEpcmV0dXJuITA7cmV0dXJuITF9dmFyIGg9ITEsaT0hMCxqPVwiLFwiLGs9XCJcXHJcXG5cIixsPSdcIic7YygpO3ZhciBtPW5ldyBSZWdFeHAobCxcImdcIik7aWYoXCJzdHJpbmdcIj09dHlwZW9mIGEmJihhPUpTT04ucGFyc2UoYSkpLGEgaW5zdGFuY2VvZiBBcnJheSl7aWYoIWEubGVuZ3RofHxhWzBdaW5zdGFuY2VvZiBBcnJheSlyZXR1cm4gZShudWxsLGEpO2lmKFwib2JqZWN0XCI9PXR5cGVvZiBhWzBdKXJldHVybiBlKGQoYVswXSksYSl9ZWxzZSBpZihcIm9iamVjdFwiPT10eXBlb2YgYSlyZXR1cm5cInN0cmluZ1wiPT10eXBlb2YgYS5kYXRhJiYoYS5kYXRhPUpTT04ucGFyc2UoYS5kYXRhKSksYS5kYXRhIGluc3RhbmNlb2YgQXJyYXkmJihhLmZpZWxkc3x8KGEuZmllbGRzPWEubWV0YSYmYS5tZXRhLmZpZWxkcyksYS5maWVsZHN8fChhLmZpZWxkcz1hLmRhdGFbMF1pbnN0YW5jZW9mIEFycmF5P2EuZmllbGRzOmQoYS5kYXRhWzBdKSksYS5kYXRhWzBdaW5zdGFuY2VvZiBBcnJheXx8XCJvYmplY3RcIj09dHlwZW9mIGEuZGF0YVswXXx8KGEuZGF0YT1bYS5kYXRhXSkpLGUoYS5maWVsZHN8fFtdLGEuZGF0YXx8W10pO3Rocm93XCJleGNlcHRpb246IFVuYWJsZSB0byBzZXJpYWxpemUgdW5yZWNvZ25pemVkIGlucHV0XCJ9ZnVuY3Rpb24gYyhhKXtmdW5jdGlvbiBiKGEpe3ZhciBiPXAoYSk7Yi5jaHVua1NpemU9cGFyc2VJbnQoYi5jaHVua1NpemUpLGEuc3RlcHx8YS5jaHVua3x8KGIuY2h1bmtTaXplPW51bGwpLHRoaXMuX2hhbmRsZT1uZXcgaChiKSx0aGlzLl9oYW5kbGUuc3RyZWFtZXI9dGhpcyx0aGlzLl9jb25maWc9Yn10aGlzLl9oYW5kbGU9bnVsbCx0aGlzLl9wYXVzZWQ9ITEsdGhpcy5fZmluaXNoZWQ9ITEsdGhpcy5faW5wdXQ9bnVsbCx0aGlzLl9iYXNlSW5kZXg9MCx0aGlzLl9wYXJ0aWFsTGluZT1cIlwiLHRoaXMuX3Jvd0NvdW50PTAsdGhpcy5fc3RhcnQ9MCx0aGlzLl9uZXh0Q2h1bms9bnVsbCx0aGlzLmlzRmlyc3RDaHVuaz0hMCx0aGlzLl9jb21wbGV0ZVJlc3VsdHM9e2RhdGE6W10sZXJyb3JzOltdLG1ldGE6e319LGIuY2FsbCh0aGlzLGEpLHRoaXMucGFyc2VDaHVuaz1mdW5jdGlvbihhKXtpZih0aGlzLmlzRmlyc3RDaHVuayYmcih0aGlzLl9jb25maWcuYmVmb3JlRmlyc3RDaHVuaykpe3ZhciBiPXRoaXMuX2NvbmZpZy5iZWZvcmVGaXJzdENodW5rKGEpO3ZvaWQgMCE9PWImJihhPWIpfXRoaXMuaXNGaXJzdENodW5rPSExO3ZhciBjPXRoaXMuX3BhcnRpYWxMaW5lK2E7dGhpcy5fcGFydGlhbExpbmU9XCJcIjt2YXIgZD10aGlzLl9oYW5kbGUucGFyc2UoYyx0aGlzLl9iYXNlSW5kZXgsIXRoaXMuX2ZpbmlzaGVkKTtpZighdGhpcy5faGFuZGxlLnBhdXNlZCgpJiYhdGhpcy5faGFuZGxlLmFib3J0ZWQoKSl7dmFyIGU9ZC5tZXRhLmN1cnNvcjt0aGlzLl9maW5pc2hlZHx8KHRoaXMuX3BhcnRpYWxMaW5lPWMuc3Vic3RyaW5nKGUtdGhpcy5fYmFzZUluZGV4KSx0aGlzLl9iYXNlSW5kZXg9ZSksZCYmZC5kYXRhJiYodGhpcy5fcm93Q291bnQrPWQuZGF0YS5sZW5ndGgpO3ZhciBmPXRoaXMuX2ZpbmlzaGVkfHx0aGlzLl9jb25maWcucHJldmlldyYmdGhpcy5fcm93Q291bnQ+PXRoaXMuX2NvbmZpZy5wcmV2aWV3O2lmKHYpdC5wb3N0TWVzc2FnZSh7cmVzdWx0czpkLHdvcmtlcklkOnouV09SS0VSX0lELGZpbmlzaGVkOmZ9KTtlbHNlIGlmKHIodGhpcy5fY29uZmlnLmNodW5rKSl7aWYodGhpcy5fY29uZmlnLmNodW5rKGQsdGhpcy5faGFuZGxlKSx0aGlzLl9wYXVzZWQpcmV0dXJuO2Q9dm9pZCAwLHRoaXMuX2NvbXBsZXRlUmVzdWx0cz12b2lkIDB9cmV0dXJuIHRoaXMuX2NvbmZpZy5zdGVwfHx0aGlzLl9jb25maWcuY2h1bmt8fCh0aGlzLl9jb21wbGV0ZVJlc3VsdHMuZGF0YT10aGlzLl9jb21wbGV0ZVJlc3VsdHMuZGF0YS5jb25jYXQoZC5kYXRhKSx0aGlzLl9jb21wbGV0ZVJlc3VsdHMuZXJyb3JzPXRoaXMuX2NvbXBsZXRlUmVzdWx0cy5lcnJvcnMuY29uY2F0KGQuZXJyb3JzKSx0aGlzLl9jb21wbGV0ZVJlc3VsdHMubWV0YT1kLm1ldGEpLCFmfHwhcih0aGlzLl9jb25maWcuY29tcGxldGUpfHxkJiZkLm1ldGEuYWJvcnRlZHx8dGhpcy5fY29uZmlnLmNvbXBsZXRlKHRoaXMuX2NvbXBsZXRlUmVzdWx0cyx0aGlzLl9pbnB1dCksZnx8ZCYmZC5tZXRhLnBhdXNlZHx8dGhpcy5fbmV4dENodW5rKCksZH19LHRoaXMuX3NlbmRFcnJvcj1mdW5jdGlvbihhKXtyKHRoaXMuX2NvbmZpZy5lcnJvcik/dGhpcy5fY29uZmlnLmVycm9yKGEpOnYmJnRoaXMuX2NvbmZpZy5lcnJvciYmdC5wb3N0TWVzc2FnZSh7d29ya2VySWQ6ei5XT1JLRVJfSUQsZXJyb3I6YSxmaW5pc2hlZDohMX0pfX1mdW5jdGlvbiBkKGEpe2Z1bmN0aW9uIGIoYSl7dmFyIGI9YS5nZXRSZXNwb25zZUhlYWRlcihcIkNvbnRlbnQtUmFuZ2VcIik7cmV0dXJuIG51bGw9PT1iPy0xOnBhcnNlSW50KGIuc3Vic3RyKGIubGFzdEluZGV4T2YoXCIvXCIpKzEpKX1hPWF8fHt9LGEuY2h1bmtTaXplfHwoYS5jaHVua1NpemU9ei5SZW1vdGVDaHVua1NpemUpLGMuY2FsbCh0aGlzLGEpO3ZhciBkO3U/dGhpcy5fbmV4dENodW5rPWZ1bmN0aW9uKCl7dGhpcy5fcmVhZENodW5rKCksdGhpcy5fY2h1bmtMb2FkZWQoKX06dGhpcy5fbmV4dENodW5rPWZ1bmN0aW9uKCl7dGhpcy5fcmVhZENodW5rKCl9LHRoaXMuc3RyZWFtPWZ1bmN0aW9uKGEpe3RoaXMuX2lucHV0PWEsdGhpcy5fbmV4dENodW5rKCl9LHRoaXMuX3JlYWRDaHVuaz1mdW5jdGlvbigpe2lmKHRoaXMuX2ZpbmlzaGVkKXJldHVybiB2b2lkIHRoaXMuX2NodW5rTG9hZGVkKCk7aWYoZD1uZXcgWE1MSHR0cFJlcXVlc3QsdGhpcy5fY29uZmlnLndpdGhDcmVkZW50aWFscyYmKGQud2l0aENyZWRlbnRpYWxzPXRoaXMuX2NvbmZpZy53aXRoQ3JlZGVudGlhbHMpLHV8fChkLm9ubG9hZD1xKHRoaXMuX2NodW5rTG9hZGVkLHRoaXMpLGQub25lcnJvcj1xKHRoaXMuX2NodW5rRXJyb3IsdGhpcykpLGQub3BlbihcIkdFVFwiLHRoaXMuX2lucHV0LCF1KSx0aGlzLl9jb25maWcuZG93bmxvYWRSZXF1ZXN0SGVhZGVycyl7dmFyIGE9dGhpcy5fY29uZmlnLmRvd25sb2FkUmVxdWVzdEhlYWRlcnM7Zm9yKHZhciBiIGluIGEpZC5zZXRSZXF1ZXN0SGVhZGVyKGIsYVtiXSl9aWYodGhpcy5fY29uZmlnLmNodW5rU2l6ZSl7dmFyIGM9dGhpcy5fc3RhcnQrdGhpcy5fY29uZmlnLmNodW5rU2l6ZS0xO2Quc2V0UmVxdWVzdEhlYWRlcihcIlJhbmdlXCIsXCJieXRlcz1cIit0aGlzLl9zdGFydCtcIi1cIitjKSxkLnNldFJlcXVlc3RIZWFkZXIoXCJJZi1Ob25lLU1hdGNoXCIsXCJ3ZWJraXQtbm8tY2FjaGVcIil9dHJ5e2Quc2VuZCgpfWNhdGNoKGEpe3RoaXMuX2NodW5rRXJyb3IoYS5tZXNzYWdlKX11JiYwPT09ZC5zdGF0dXM/dGhpcy5fY2h1bmtFcnJvcigpOnRoaXMuX3N0YXJ0Kz10aGlzLl9jb25maWcuY2h1bmtTaXplfSx0aGlzLl9jaHVua0xvYWRlZD1mdW5jdGlvbigpe2lmKDQ9PWQucmVhZHlTdGF0ZSl7aWYoZC5zdGF0dXM8MjAwfHxkLnN0YXR1cz49NDAwKXJldHVybiB2b2lkIHRoaXMuX2NodW5rRXJyb3IoKTt0aGlzLl9maW5pc2hlZD0hdGhpcy5fY29uZmlnLmNodW5rU2l6ZXx8dGhpcy5fc3RhcnQ+YihkKSx0aGlzLnBhcnNlQ2h1bmsoZC5yZXNwb25zZVRleHQpfX0sdGhpcy5fY2h1bmtFcnJvcj1mdW5jdGlvbihhKXt2YXIgYj1kLnN0YXR1c1RleHR8fGE7dGhpcy5fc2VuZEVycm9yKGIpfX1mdW5jdGlvbiBlKGEpe2E9YXx8e30sYS5jaHVua1NpemV8fChhLmNodW5rU2l6ZT16LkxvY2FsQ2h1bmtTaXplKSxjLmNhbGwodGhpcyxhKTt2YXIgYixkLGU9XCJ1bmRlZmluZWRcIiE9dHlwZW9mIEZpbGVSZWFkZXI7dGhpcy5zdHJlYW09ZnVuY3Rpb24oYSl7dGhpcy5faW5wdXQ9YSxkPWEuc2xpY2V8fGEud2Via2l0U2xpY2V8fGEubW96U2xpY2UsZT8oYj1uZXcgRmlsZVJlYWRlcixiLm9ubG9hZD1xKHRoaXMuX2NodW5rTG9hZGVkLHRoaXMpLGIub25lcnJvcj1xKHRoaXMuX2NodW5rRXJyb3IsdGhpcykpOmI9bmV3IEZpbGVSZWFkZXJTeW5jLHRoaXMuX25leHRDaHVuaygpfSx0aGlzLl9uZXh0Q2h1bms9ZnVuY3Rpb24oKXt0aGlzLl9maW5pc2hlZHx8dGhpcy5fY29uZmlnLnByZXZpZXcmJiEodGhpcy5fcm93Q291bnQ8dGhpcy5fY29uZmlnLnByZXZpZXcpfHx0aGlzLl9yZWFkQ2h1bmsoKX0sdGhpcy5fcmVhZENodW5rPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5faW5wdXQ7aWYodGhpcy5fY29uZmlnLmNodW5rU2l6ZSl7dmFyIGM9TWF0aC5taW4odGhpcy5fc3RhcnQrdGhpcy5fY29uZmlnLmNodW5rU2l6ZSx0aGlzLl9pbnB1dC5zaXplKTthPWQuY2FsbChhLHRoaXMuX3N0YXJ0LGMpfXZhciBmPWIucmVhZEFzVGV4dChhLHRoaXMuX2NvbmZpZy5lbmNvZGluZyk7ZXx8dGhpcy5fY2h1bmtMb2FkZWQoe3RhcmdldDp7cmVzdWx0OmZ9fSl9LHRoaXMuX2NodW5rTG9hZGVkPWZ1bmN0aW9uKGEpe3RoaXMuX3N0YXJ0Kz10aGlzLl9jb25maWcuY2h1bmtTaXplLHRoaXMuX2ZpbmlzaGVkPSF0aGlzLl9jb25maWcuY2h1bmtTaXplfHx0aGlzLl9zdGFydD49dGhpcy5faW5wdXQuc2l6ZSx0aGlzLnBhcnNlQ2h1bmsoYS50YXJnZXQucmVzdWx0KX0sdGhpcy5fY2h1bmtFcnJvcj1mdW5jdGlvbigpe3RoaXMuX3NlbmRFcnJvcihiLmVycm9yLm1lc3NhZ2UpfX1mdW5jdGlvbiBmKGEpe2E9YXx8e30sYy5jYWxsKHRoaXMsYSk7dmFyIGIsZDt0aGlzLnN0cmVhbT1mdW5jdGlvbihhKXtyZXR1cm4gYj1hLGQ9YSx0aGlzLl9uZXh0Q2h1bmsoKX0sdGhpcy5fbmV4dENodW5rPWZ1bmN0aW9uKCl7aWYoIXRoaXMuX2ZpbmlzaGVkKXt2YXIgYT10aGlzLl9jb25maWcuY2h1bmtTaXplLGI9YT9kLnN1YnN0cigwLGEpOmQ7cmV0dXJuIGQ9YT9kLnN1YnN0cihhKTpcIlwiLHRoaXMuX2ZpbmlzaGVkPSFkLHRoaXMucGFyc2VDaHVuayhiKX19fWZ1bmN0aW9uIGcoYSl7YT1hfHx7fSxjLmNhbGwodGhpcyxhKTt2YXIgYj1bXSxkPSEwO3RoaXMuc3RyZWFtPWZ1bmN0aW9uKGEpe3RoaXMuX2lucHV0PWEsdGhpcy5faW5wdXQub24oXCJkYXRhXCIsdGhpcy5fc3RyZWFtRGF0YSksdGhpcy5faW5wdXQub24oXCJlbmRcIix0aGlzLl9zdHJlYW1FbmQpLHRoaXMuX2lucHV0Lm9uKFwiZXJyb3JcIix0aGlzLl9zdHJlYW1FcnJvcil9LHRoaXMuX25leHRDaHVuaz1mdW5jdGlvbigpe2IubGVuZ3RoP3RoaXMucGFyc2VDaHVuayhiLnNoaWZ0KCkpOmQ9ITB9LHRoaXMuX3N0cmVhbURhdGE9cShmdW5jdGlvbihhKXt0cnl7Yi5wdXNoKFwic3RyaW5nXCI9PXR5cGVvZiBhP2E6YS50b1N0cmluZyh0aGlzLl9jb25maWcuZW5jb2RpbmcpKSxkJiYoZD0hMSx0aGlzLnBhcnNlQ2h1bmsoYi5zaGlmdCgpKSl9Y2F0Y2goYSl7dGhpcy5fc3RyZWFtRXJyb3IoYSl9fSx0aGlzKSx0aGlzLl9zdHJlYW1FcnJvcj1xKGZ1bmN0aW9uKGEpe3RoaXMuX3N0cmVhbUNsZWFuVXAoKSx0aGlzLl9zZW5kRXJyb3IoYS5tZXNzYWdlKX0sdGhpcyksdGhpcy5fc3RyZWFtRW5kPXEoZnVuY3Rpb24oKXt0aGlzLl9zdHJlYW1DbGVhblVwKCksdGhpcy5fZmluaXNoZWQ9ITAsdGhpcy5fc3RyZWFtRGF0YShcIlwiKX0sdGhpcyksdGhpcy5fc3RyZWFtQ2xlYW5VcD1xKGZ1bmN0aW9uKCl7dGhpcy5faW5wdXQucmVtb3ZlTGlzdGVuZXIoXCJkYXRhXCIsdGhpcy5fc3RyZWFtRGF0YSksdGhpcy5faW5wdXQucmVtb3ZlTGlzdGVuZXIoXCJlbmRcIix0aGlzLl9zdHJlYW1FbmQpLHRoaXMuX2lucHV0LnJlbW92ZUxpc3RlbmVyKFwiZXJyb3JcIix0aGlzLl9zdHJlYW1FcnJvcil9LHRoaXMpfWZ1bmN0aW9uIGgoYSl7ZnVuY3Rpb24gYigpe2lmKHgmJm8mJihsKFwiRGVsaW1pdGVyXCIsXCJVbmRldGVjdGFibGVEZWxpbWl0ZXJcIixcIlVuYWJsZSB0byBhdXRvLWRldGVjdCBkZWxpbWl0aW5nIGNoYXJhY3RlcjsgZGVmYXVsdGVkIHRvICdcIit6LkRlZmF1bHREZWxpbWl0ZXIrXCInXCIpLG89ITEpLGEuc2tpcEVtcHR5TGluZXMpZm9yKHZhciBiPTA7Yjx4LmRhdGEubGVuZ3RoO2IrKykxPT09eC5kYXRhW2JdLmxlbmd0aCYmXCJcIj09PXguZGF0YVtiXVswXSYmeC5kYXRhLnNwbGljZShiLS0sMSk7cmV0dXJuIGMoKSYmZCgpLGcoKX1mdW5jdGlvbiBjKCl7cmV0dXJuIGEuaGVhZGVyJiYwPT09dy5sZW5ndGh9ZnVuY3Rpb24gZCgpe2lmKHgpe2Zvcih2YXIgYT0wO2MoKSYmYTx4LmRhdGEubGVuZ3RoO2ErKylmb3IodmFyIGI9MDtiPHguZGF0YVthXS5sZW5ndGg7YisrKXcucHVzaCh4LmRhdGFbYV1bYl0pO3guZGF0YS5zcGxpY2UoMCwxKX19ZnVuY3Rpb24gZShiKXtyZXR1cm4gYS5keW5hbWljVHlwaW5nRnVuY3Rpb24mJnZvaWQgMD09PWEuZHluYW1pY1R5cGluZ1tiXSYmKGEuZHluYW1pY1R5cGluZ1tiXT1hLmR5bmFtaWNUeXBpbmdGdW5jdGlvbihiKSksKGEuZHluYW1pY1R5cGluZ1tiXXx8YS5keW5hbWljVHlwaW5nKT09PSEwfWZ1bmN0aW9uIGYoYSxiKXtyZXR1cm4gZShhKT9cInRydWVcIj09PWJ8fFwiVFJVRVwiPT09Ynx8XCJmYWxzZVwiIT09YiYmXCJGQUxTRVwiIT09YiYmayhiKTpifWZ1bmN0aW9uIGcoKXtpZigheHx8IWEuaGVhZGVyJiYhYS5keW5hbWljVHlwaW5nKXJldHVybiB4O2Zvcih2YXIgYj0wO2I8eC5kYXRhLmxlbmd0aDtiKyspe2Zvcih2YXIgYz1hLmhlYWRlcj97fTpbXSxkPTA7ZDx4LmRhdGFbYl0ubGVuZ3RoO2QrKyl7dmFyIGU9ZCxnPXguZGF0YVtiXVtkXTthLmhlYWRlciYmKGU9ZD49dy5sZW5ndGg/XCJfX3BhcnNlZF9leHRyYVwiOndbZF0pLGc9ZihlLGcpLFwiX19wYXJzZWRfZXh0cmFcIj09PWU/KGNbZV09Y1tlXXx8W10sY1tlXS5wdXNoKGcpKTpjW2VdPWd9eC5kYXRhW2JdPWMsYS5oZWFkZXImJihkPncubGVuZ3RoP2woXCJGaWVsZE1pc21hdGNoXCIsXCJUb29NYW55RmllbGRzXCIsXCJUb28gbWFueSBmaWVsZHM6IGV4cGVjdGVkIFwiK3cubGVuZ3RoK1wiIGZpZWxkcyBidXQgcGFyc2VkIFwiK2QsYik6ZDx3Lmxlbmd0aCYmbChcIkZpZWxkTWlzbWF0Y2hcIixcIlRvb0Zld0ZpZWxkc1wiLFwiVG9vIGZldyBmaWVsZHM6IGV4cGVjdGVkIFwiK3cubGVuZ3RoK1wiIGZpZWxkcyBidXQgcGFyc2VkIFwiK2QsYikpfXJldHVybiBhLmhlYWRlciYmeC5tZXRhJiYoeC5tZXRhLmZpZWxkcz13KSx4fWZ1bmN0aW9uIGgoYixjLGQpe2Zvcih2YXIgZSxmLGcsaD1bXCIsXCIsXCJcXHRcIixcInxcIixcIjtcIix6LlJFQ09SRF9TRVAsei5VTklUX1NFUF0saj0wO2o8aC5sZW5ndGg7aisrKXt2YXIgaz1oW2pdLGw9MCxtPTAsbj0wO2c9dm9pZCAwO2Zvcih2YXIgbz1uZXcgaSh7ZGVsaW1pdGVyOmssbmV3bGluZTpjLHByZXZpZXc6MTB9KS5wYXJzZShiKSxwPTA7cDxvLmRhdGEubGVuZ3RoO3ArKylpZihkJiYxPT09by5kYXRhW3BdLmxlbmd0aCYmMD09PW8uZGF0YVtwXVswXS5sZW5ndGgpbisrO2Vsc2V7dmFyIHE9by5kYXRhW3BdLmxlbmd0aDttKz1xLFwidW5kZWZpbmVkXCIhPXR5cGVvZiBnP3E+MSYmKGwrPU1hdGguYWJzKHEtZyksZz1xKTpnPXF9by5kYXRhLmxlbmd0aD4wJiYobS89by5kYXRhLmxlbmd0aC1uKSwoXCJ1bmRlZmluZWRcIj09dHlwZW9mIGZ8fGw8ZikmJm0+MS45OSYmKGY9bCxlPWspfXJldHVybiBhLmRlbGltaXRlcj1lLHtzdWNjZXNzZnVsOiEhZSxiZXN0RGVsaW1pdGVyOmV9fWZ1bmN0aW9uIGooYSl7YT1hLnN1YnN0cigwLDEwNDg1NzYpO3ZhciBiPWEuc3BsaXQoXCJcXHJcIiksYz1hLnNwbGl0KFwiXFxuXCIpLGQ9Yy5sZW5ndGg+MSYmY1swXS5sZW5ndGg8YlswXS5sZW5ndGg7aWYoMT09PWIubGVuZ3RofHxkKXJldHVyblwiXFxuXCI7Zm9yKHZhciBlPTAsZj0wO2Y8Yi5sZW5ndGg7ZisrKVwiXFxuXCI9PT1iW2ZdWzBdJiZlKys7cmV0dXJuIGU+PWIubGVuZ3RoLzI/XCJcXHJcXG5cIjpcIlxcclwifWZ1bmN0aW9uIGsoYSl7dmFyIGI9cS50ZXN0KGEpO3JldHVybiBiP3BhcnNlRmxvYXQoYSk6YX1mdW5jdGlvbiBsKGEsYixjLGQpe3guZXJyb3JzLnB1c2goe3R5cGU6YSxjb2RlOmIsbWVzc2FnZTpjLHJvdzpkfSl9dmFyIG0sbixvLHE9L15cXHMqLT8oXFxkKlxcLj9cXGQrfFxcZCtcXC4/XFxkKikoZVstK10/XFxkKyk/XFxzKiQvaSxzPXRoaXMsdD0wLHU9ITEsdj0hMSx3PVtdLHg9e2RhdGE6W10sZXJyb3JzOltdLG1ldGE6e319O2lmKHIoYS5zdGVwKSl7dmFyIHk9YS5zdGVwO2Euc3RlcD1mdW5jdGlvbihkKXtpZih4PWQsYygpKWIoKTtlbHNle2lmKGIoKSwwPT09eC5kYXRhLmxlbmd0aClyZXR1cm47dCs9ZC5kYXRhLmxlbmd0aCxhLnByZXZpZXcmJnQ+YS5wcmV2aWV3P24uYWJvcnQoKTp5KHgscyl9fX10aGlzLnBhcnNlPWZ1bmN0aW9uKGMsZCxlKXtpZihhLm5ld2xpbmV8fChhLm5ld2xpbmU9aihjKSksbz0hMSxhLmRlbGltaXRlcilyKGEuZGVsaW1pdGVyKSYmKGEuZGVsaW1pdGVyPWEuZGVsaW1pdGVyKGMpLHgubWV0YS5kZWxpbWl0ZXI9YS5kZWxpbWl0ZXIpO2Vsc2V7dmFyIGY9aChjLGEubmV3bGluZSxhLnNraXBFbXB0eUxpbmVzKTtmLnN1Y2Nlc3NmdWw/YS5kZWxpbWl0ZXI9Zi5iZXN0RGVsaW1pdGVyOihvPSEwLGEuZGVsaW1pdGVyPXouRGVmYXVsdERlbGltaXRlcikseC5tZXRhLmRlbGltaXRlcj1hLmRlbGltaXRlcn12YXIgZz1wKGEpO3JldHVybiBhLnByZXZpZXcmJmEuaGVhZGVyJiZnLnByZXZpZXcrKyxtPWMsbj1uZXcgaShnKSx4PW4ucGFyc2UobSxkLGUpLGIoKSx1P3ttZXRhOntwYXVzZWQ6ITB9fTp4fHx7bWV0YTp7cGF1c2VkOiExfX19LHRoaXMucGF1c2VkPWZ1bmN0aW9uKCl7cmV0dXJuIHV9LHRoaXMucGF1c2U9ZnVuY3Rpb24oKXt1PSEwLG4uYWJvcnQoKSxtPW0uc3Vic3RyKG4uZ2V0Q2hhckluZGV4KCkpfSx0aGlzLnJlc3VtZT1mdW5jdGlvbigpe3U9ITEscy5zdHJlYW1lci5wYXJzZUNodW5rKG0pfSx0aGlzLmFib3J0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdn0sdGhpcy5hYm9ydD1mdW5jdGlvbigpe3Y9ITAsbi5hYm9ydCgpLHgubWV0YS5hYm9ydGVkPSEwLHIoYS5jb21wbGV0ZSkmJmEuY29tcGxldGUoeCksbT1cIlwifX1mdW5jdGlvbiBpKGEpe2E9YXx8e307dmFyIGI9YS5kZWxpbWl0ZXIsYz1hLm5ld2xpbmUsZD1hLmNvbW1lbnRzLGU9YS5zdGVwLGY9YS5wcmV2aWV3LGc9YS5mYXN0TW9kZTtpZih2b2lkIDA9PT1hLnF1b3RlQ2hhcil2YXIgaD0nXCInO2Vsc2UgdmFyIGg9YS5xdW90ZUNoYXI7aWYoKFwic3RyaW5nXCIhPXR5cGVvZiBifHx6LkJBRF9ERUxJTUlURVJTLmluZGV4T2YoYik+LTEpJiYoYj1cIixcIiksZD09PWIpdGhyb3dcIkNvbW1lbnQgY2hhcmFjdGVyIHNhbWUgYXMgZGVsaW1pdGVyXCI7ZD09PSEwP2Q9XCIjXCI6KFwic3RyaW5nXCIhPXR5cGVvZiBkfHx6LkJBRF9ERUxJTUlURVJTLmluZGV4T2YoZCk+LTEpJiYoZD0hMSksXCJcXG5cIiE9YyYmXCJcXHJcIiE9YyYmXCJcXHJcXG5cIiE9YyYmKGM9XCJcXG5cIik7dmFyIGk9MCxqPSExO3RoaXMucGFyc2U9ZnVuY3Rpb24oYSxrLGwpe2Z1bmN0aW9uIG0oYSl7eC5wdXNoKGEpLEE9aX1mdW5jdGlvbiBuKGIpe3JldHVybiBsP3AoKTooXCJ1bmRlZmluZWRcIj09dHlwZW9mIGImJihiPWEuc3Vic3RyKGkpKSx6LnB1c2goYiksaT1zLG0oeiksdyYmcSgpLHAoKSl9ZnVuY3Rpb24gbyhiKXtpPWIsbSh6KSx6PVtdLEU9YS5pbmRleE9mKGMsaSl9ZnVuY3Rpb24gcChhKXtyZXR1cm57ZGF0YTp4LGVycm9yczp5LG1ldGE6e2RlbGltaXRlcjpiLGxpbmVicmVhazpjLGFib3J0ZWQ6aix0cnVuY2F0ZWQ6ISFhLGN1cnNvcjpBKyhrfHwwKX19fWZ1bmN0aW9uIHEoKXtlKHAoKSkseD1bXSx5PVtdfWlmKFwic3RyaW5nXCIhPXR5cGVvZiBhKXRocm93XCJJbnB1dCBtdXN0IGJlIGEgc3RyaW5nXCI7dmFyIHM9YS5sZW5ndGgsdD1iLmxlbmd0aCx1PWMubGVuZ3RoLHY9ZC5sZW5ndGgsdz1yKGUpO2k9MDt2YXIgeD1bXSx5PVtdLHo9W10sQT0wO2lmKCFhKXJldHVybiBwKCk7aWYoZ3x8ZyE9PSExJiZhLmluZGV4T2YoaCk9PT0tMSl7Zm9yKHZhciBCPWEuc3BsaXQoYyksQz0wO0M8Qi5sZW5ndGg7QysrKXt2YXIgej1CW0NdO2lmKGkrPXoubGVuZ3RoLEMhPT1CLmxlbmd0aC0xKWkrPWMubGVuZ3RoO2Vsc2UgaWYobClyZXR1cm4gcCgpO2lmKCFkfHx6LnN1YnN0cigwLHYpIT09ZCl7aWYodyl7aWYoeD1bXSxtKHouc3BsaXQoYikpLHEoKSxqKXJldHVybiBwKCl9ZWxzZSBtKHouc3BsaXQoYikpO2lmKGYmJkM+PWYpcmV0dXJuIHg9eC5zbGljZSgwLGYpLHAoITApfX1yZXR1cm4gcCgpfWZvcih2YXIgRD1hLmluZGV4T2YoYixpKSxFPWEuaW5kZXhPZihjLGkpLEY9bmV3IFJlZ0V4cChoK2gsXCJnXCIpOzspaWYoYVtpXSE9PWgpaWYoZCYmMD09PXoubGVuZ3RoJiZhLnN1YnN0cihpLHYpPT09ZCl7aWYoRT09PS0xKXJldHVybiBwKCk7aT1FK3UsRT1hLmluZGV4T2YoYyxpKSxEPWEuaW5kZXhPZihiLGkpfWVsc2UgaWYoRCE9PS0xJiYoRDxFfHxFPT09LTEpKXoucHVzaChhLnN1YnN0cmluZyhpLEQpKSxpPUQrdCxEPWEuaW5kZXhPZihiLGkpO2Vsc2V7aWYoRT09PS0xKWJyZWFrO2lmKHoucHVzaChhLnN1YnN0cmluZyhpLEUpKSxvKEUrdSksdyYmKHEoKSxqKSlyZXR1cm4gcCgpO2lmKGYmJngubGVuZ3RoPj1mKXJldHVybiBwKCEwKX1lbHNle3ZhciBHPWk7Zm9yKGkrKzs7KXt2YXIgRz1hLmluZGV4T2YoaCxHKzEpO2lmKEc9PT0tMSlyZXR1cm4gbHx8eS5wdXNoKHt0eXBlOlwiUXVvdGVzXCIsY29kZTpcIk1pc3NpbmdRdW90ZXNcIixtZXNzYWdlOlwiUXVvdGVkIGZpZWxkIHVudGVybWluYXRlZFwiLHJvdzp4Lmxlbmd0aCxpbmRleDppfSksbigpO2lmKEc9PT1zLTEpe3ZhciBIPWEuc3Vic3RyaW5nKGksRykucmVwbGFjZShGLGgpO3JldHVybiBuKEgpfWlmKGFbRysxXSE9PWgpe2lmKGFbRysxXT09PWIpe3oucHVzaChhLnN1YnN0cmluZyhpLEcpLnJlcGxhY2UoRixoKSksaT1HKzErdCxEPWEuaW5kZXhPZihiLGkpLEU9YS5pbmRleE9mKGMsaSk7YnJlYWt9aWYoYS5zdWJzdHIoRysxLHUpPT09Yyl7aWYoei5wdXNoKGEuc3Vic3RyaW5nKGksRykucmVwbGFjZShGLGgpKSxvKEcrMSt1KSxEPWEuaW5kZXhPZihiLGkpLHcmJihxKCksaikpcmV0dXJuIHAoKTtpZihmJiZ4Lmxlbmd0aD49ZilyZXR1cm4gcCghMCk7YnJlYWt9eS5wdXNoKHt0eXBlOlwiUXVvdGVzXCIsY29kZTpcIkludmFsaWRRdW90ZXNcIixtZXNzYWdlOlwiVHJhaWxpbmcgcXVvdGUgb24gcXVvdGVkIGZpZWxkIGlzIG1hbGZvcm1lZFwiLHJvdzp4Lmxlbmd0aCxpbmRleDppfSksRysrfWVsc2UgRysrfX1yZXR1cm4gbigpfSx0aGlzLmFib3J0PWZ1bmN0aW9uKCl7aj0hMH0sdGhpcy5nZXRDaGFySW5kZXg9ZnVuY3Rpb24oKXtyZXR1cm4gaX19ZnVuY3Rpb24gaigpe3ZhciBhPWRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic2NyaXB0XCIpO3JldHVybiBhLmxlbmd0aD9hW2EubGVuZ3RoLTFdLnNyYzpcIlwifWZ1bmN0aW9uIGsoKXtpZighei5XT1JLRVJTX1NVUFBPUlRFRClyZXR1cm4hMTtpZighdyYmbnVsbD09PXouU0NSSVBUX1BBVEgpdGhyb3cgbmV3IEVycm9yKFwiU2NyaXB0IHBhdGggY2Fubm90IGJlIGRldGVybWluZWQgYXV0b21hdGljYWxseSB3aGVuIFBhcGEgUGFyc2UgaXMgbG9hZGVkIGFzeW5jaHJvbm91c2x5LiBZb3UgbmVlZCB0byBzZXQgUGFwYS5TQ1JJUFRfUEFUSCBtYW51YWxseS5cIik7dmFyIGE9ei5TQ1JJUFRfUEFUSHx8czthKz0oYS5pbmRleE9mKFwiP1wiKSE9PS0xP1wiJlwiOlwiP1wiKStcInBhcGF3b3JrZXJcIjt2YXIgYj1uZXcgdC5Xb3JrZXIoYSk7cmV0dXJuIGIub25tZXNzYWdlPWwsYi5pZD15KysseFtiLmlkXT1iLGJ9ZnVuY3Rpb24gbChhKXt2YXIgYj1hLmRhdGEsYz14W2Iud29ya2VySWRdLGQ9ITE7aWYoYi5lcnJvciljLnVzZXJFcnJvcihiLmVycm9yLGIuZmlsZSk7ZWxzZSBpZihiLnJlc3VsdHMmJmIucmVzdWx0cy5kYXRhKXt2YXIgZT1mdW5jdGlvbigpe2Q9ITAsbShiLndvcmtlcklkLHtkYXRhOltdLGVycm9yczpbXSxtZXRhOnthYm9ydGVkOiEwfX0pfSxmPXthYm9ydDplLHBhdXNlOm4scmVzdW1lOm59O2lmKHIoYy51c2VyU3RlcCkpe2Zvcih2YXIgZz0wO2c8Yi5yZXN1bHRzLmRhdGEubGVuZ3RoJiYoYy51c2VyU3RlcCh7ZGF0YTpbYi5yZXN1bHRzLmRhdGFbZ11dLGVycm9yczpiLnJlc3VsdHMuZXJyb3JzLG1ldGE6Yi5yZXN1bHRzLm1ldGF9LGYpLCFkKTtnKyspO2RlbGV0ZSBiLnJlc3VsdHN9ZWxzZSByKGMudXNlckNodW5rKSYmKGMudXNlckNodW5rKGIucmVzdWx0cyxmLGIuZmlsZSksZGVsZXRlIGIucmVzdWx0cyl9Yi5maW5pc2hlZCYmIWQmJm0oYi53b3JrZXJJZCxiLnJlc3VsdHMpfWZ1bmN0aW9uIG0oYSxiKXt2YXIgYz14W2FdO3IoYy51c2VyQ29tcGxldGUpJiZjLnVzZXJDb21wbGV0ZShiKSxjLnRlcm1pbmF0ZSgpLGRlbGV0ZSB4W2FdfWZ1bmN0aW9uIG4oKXt0aHJvd1wiTm90IGltcGxlbWVudGVkLlwifWZ1bmN0aW9uIG8oYSl7dmFyIGI9YS5kYXRhO2lmKFwidW5kZWZpbmVkXCI9PXR5cGVvZiB6LldPUktFUl9JRCYmYiYmKHouV09SS0VSX0lEPWIud29ya2VySWQpLFwic3RyaW5nXCI9PXR5cGVvZiBiLmlucHV0KXQucG9zdE1lc3NhZ2Uoe3dvcmtlcklkOnouV09SS0VSX0lELHJlc3VsdHM6ei5wYXJzZShiLmlucHV0LGIuY29uZmlnKSxmaW5pc2hlZDohMH0pO2Vsc2UgaWYodC5GaWxlJiZiLmlucHV0IGluc3RhbmNlb2YgRmlsZXx8Yi5pbnB1dCBpbnN0YW5jZW9mIE9iamVjdCl7dmFyIGM9ei5wYXJzZShiLmlucHV0LGIuY29uZmlnKTtjJiZ0LnBvc3RNZXNzYWdlKHt3b3JrZXJJZDp6LldPUktFUl9JRCxyZXN1bHRzOmMsZmluaXNoZWQ6ITB9KX19ZnVuY3Rpb24gcChhKXtpZihcIm9iamVjdFwiIT10eXBlb2YgYSlyZXR1cm4gYTt2YXIgYj1hIGluc3RhbmNlb2YgQXJyYXk/W106e307Zm9yKHZhciBjIGluIGEpYltjXT1wKGFbY10pO3JldHVybiBifWZ1bmN0aW9uIHEoYSxiKXtyZXR1cm4gZnVuY3Rpb24oKXthLmFwcGx5KGIsYXJndW1lbnRzKX19ZnVuY3Rpb24gcihhKXtyZXR1cm5cImZ1bmN0aW9uXCI9PXR5cGVvZiBhfXZhciBzLHQ9ZnVuY3Rpb24oKXtyZXR1cm5cInVuZGVmaW5lZFwiIT10eXBlb2Ygc2VsZj9zZWxmOlwidW5kZWZpbmVkXCIhPXR5cGVvZiB3aW5kb3c/d2luZG93OlwidW5kZWZpbmVkXCIhPXR5cGVvZiB0P3Q6e319KCksdT0hdC5kb2N1bWVudCYmISF0LnBvc3RNZXNzYWdlLHY9dSYmLyhcXD98JilwYXBhd29ya2VyKD18JnwkKS8udGVzdCh0LmxvY2F0aW9uLnNlYXJjaCksdz0hMSx4PXt9LHk9MCx6PXt9O2lmKHoucGFyc2U9YSx6LnVucGFyc2U9Yix6LlJFQ09SRF9TRVA9U3RyaW5nLmZyb21DaGFyQ29kZSgzMCksei5VTklUX1NFUD1TdHJpbmcuZnJvbUNoYXJDb2RlKDMxKSx6LkJZVEVfT1JERVJfTUFSSz1cIlxcdWZlZmZcIix6LkJBRF9ERUxJTUlURVJTPVtcIlxcclwiLFwiXFxuXCIsJ1wiJyx6LkJZVEVfT1JERVJfTUFSS10sei5XT1JLRVJTX1NVUFBPUlRFRD0hdSYmISF0Lldvcmtlcix6LlNDUklQVF9QQVRIPW51bGwsei5Mb2NhbENodW5rU2l6ZT0xMDQ4NTc2MCx6LlJlbW90ZUNodW5rU2l6ZT01MjQyODgwLHouRGVmYXVsdERlbGltaXRlcj1cIixcIix6LlBhcnNlcj1pLHouUGFyc2VySGFuZGxlPWgsei5OZXR3b3JrU3RyZWFtZXI9ZCx6LkZpbGVTdHJlYW1lcj1lLHouU3RyaW5nU3RyZWFtZXI9Zix6LlJlYWRhYmxlU3RyZWFtU3RyZWFtZXI9Zyx0LmpRdWVyeSl7dmFyIEE9dC5qUXVlcnk7QS5mbi5wYXJzZT1mdW5jdGlvbihhKXtmdW5jdGlvbiBiKCl7aWYoMD09PWYubGVuZ3RoKXJldHVybiB2b2lkKHIoYS5jb21wbGV0ZSkmJmEuY29tcGxldGUoKSk7dmFyIGI9ZlswXTtpZihyKGEuYmVmb3JlKSl7dmFyIGU9YS5iZWZvcmUoYi5maWxlLGIuaW5wdXRFbGVtKTtpZihcIm9iamVjdFwiPT10eXBlb2YgZSl7aWYoXCJhYm9ydFwiPT09ZS5hY3Rpb24pcmV0dXJuIHZvaWQgYyhcIkFib3J0RXJyb3JcIixiLmZpbGUsYi5pbnB1dEVsZW0sZS5yZWFzb24pO2lmKFwic2tpcFwiPT09ZS5hY3Rpb24pcmV0dXJuIHZvaWQgZCgpO1wib2JqZWN0XCI9PXR5cGVvZiBlLmNvbmZpZyYmKGIuaW5zdGFuY2VDb25maWc9QS5leHRlbmQoYi5pbnN0YW5jZUNvbmZpZyxlLmNvbmZpZykpfWVsc2UgaWYoXCJza2lwXCI9PT1lKXJldHVybiB2b2lkIGQoKX12YXIgZz1iLmluc3RhbmNlQ29uZmlnLmNvbXBsZXRlO2IuaW5zdGFuY2VDb25maWcuY29tcGxldGU9ZnVuY3Rpb24oYSl7cihnKSYmZyhhLGIuZmlsZSxiLmlucHV0RWxlbSksZCgpfSx6LnBhcnNlKGIuZmlsZSxiLmluc3RhbmNlQ29uZmlnKX1mdW5jdGlvbiBjKGIsYyxkLGUpe3IoYS5lcnJvcikmJmEuZXJyb3Ioe25hbWU6Yn0sYyxkLGUpfWZ1bmN0aW9uIGQoKXtmLnNwbGljZSgwLDEpLGIoKX12YXIgZT1hLmNvbmZpZ3x8e30sZj1bXTtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGEpe3ZhciBiPVwiSU5QVVRcIj09PUEodGhpcykucHJvcChcInRhZ05hbWVcIikudG9VcHBlckNhc2UoKSYmXCJmaWxlXCI9PT1BKHRoaXMpLmF0dHIoXCJ0eXBlXCIpLnRvTG93ZXJDYXNlKCkmJnQuRmlsZVJlYWRlcjtpZighYnx8IXRoaXMuZmlsZXN8fDA9PT10aGlzLmZpbGVzLmxlbmd0aClyZXR1cm4hMDtmb3IodmFyIGM9MDtjPHRoaXMuZmlsZXMubGVuZ3RoO2MrKylmLnB1c2goe2ZpbGU6dGhpcy5maWxlc1tjXSxpbnB1dEVsZW06dGhpcyxpbnN0YW5jZUNvbmZpZzpBLmV4dGVuZCh7fSxlKX0pfSksYigpLHRoaXN9fXJldHVybiB2P3Qub25tZXNzYWdlPW86ei5XT1JLRVJTX1NVUFBPUlRFRCYmKHM9aigpLGRvY3VtZW50LmJvZHk/ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIixmdW5jdGlvbigpe3c9ITB9LCEwKTp3PSEwKSxkLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGMucHJvdG90eXBlKSxkLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1kLGUucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoYy5wcm90b3R5cGUpLGUucHJvdG90eXBlLmNvbnN0cnVjdG9yPWUsZi5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShmLnByb3RvdHlwZSksZi5wcm90b3R5cGUuY29uc3RydWN0b3I9ZixnLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGMucHJvdG90eXBlKSxnLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1nLHp9KTsiLCJ2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoXCJmaWxldXBsb2FkXCIsIFsndWkucm91dGVyJywgJ3VpLmJvb3RzdHJhcCddKTtcclxuXHJcbmFwcC5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsJHVybFJvdXRlclByb3ZpZGVyKSB7XHJcblxyXG4gICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoe1xyXG4gICAgICAgIG5hbWU6ICdob21lJyxcclxuICAgICAgICB1cmw6ICcvJyxcclxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL2hvbWUuaHRtbCdcclxuICAgIH0pO1xyXG4gICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoe1xyXG4gICAgICAgIG5hbWU6ICdmaWxlVXBsb2FkJyxcclxuICAgICAgICB1cmw6ICcvZmlsZVVwbG9hZCcsXHJcbiAgICAgICAgY29udHJvbGxlcjpcImZpbGVVcGxvYWRDb250cm9sbGVyXCIsXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9maWxlVXBsb2FkLmh0bWwnLFxyXG4gICAgfSk7XHJcbn0pOyIsImFwcC5jb250cm9sbGVyKFwiZmlsZVVwbG9hZENvbnRyb2xsZXJcIixmdW5jdGlvbigkc2NvcGUsJHRpbWVvdXQsJHVpYk1vZGFsKXtcclxuICAgIFxyXG4gICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgIF90aGlzLnNob3dVcGxvYWRCdG4gPSBmYWxzZTtcclxuICAgIF90aGlzLnNob3dQcm9ncmVzc0JhciA9IGZhbHNlO1xyXG4gICBcclxuICAgIHZhciBqc29uT2JqID0gW107XHJcbiAgICAvL2Z1bmN0aW9uIHRvIGFjY2VwdCBjc3YgZmlsZVxyXG4gICAgJHNjb3BlLnBhcnNlQ3N2RmlsZSA9IGZ1bmN0aW9uKGV2dCl7XHJcbiAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgX3RoaXMuc2hvd1Byb2dyZXNzQmFyID0gdHJ1ZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgZWxlbSA9IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2dyZXNzYmFyXCIpKTtcclxuICAgICAgICB2YXIgZmlsZXMgPSBldnQuZmlsZXNbMF07XHJcbiAgICAgICAgX3RoaXMuZmlsZU5hbWUgPSBmaWxlcy5uYW1lO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciByZWFkQ3N2ID0gbmV3IEZpbGVSZWFkZXIoKTtcclxuICAgICAgICB2YXIgcm93Q291bnQgPSAwOyAgICBcclxuICAgICAgICAvL3JlYWRzIHRoZSBmaWxlIG9ubG9hZCAmIHBhc3Mgb25lIGJ5IG9uZSByZWNvcmRzIHRvIHBhcnNlSlNPTigpIHRvIGZvciBKU09OIG9iamVjdCBvZiBlYWNoIHJlY29yZFxyXG4gICAgICAgIHJlYWRDc3Yub25sb2FkID0gZnVuY3Rpb24oZXZlbnQpIHsgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlY29yZCA9IHRoaXMucmVzdWx0LnNwbGl0KCdcXG4nKS5sZW5ndGg7XHJcbiAgICAgICAgICAgIFBhcGEucGFyc2UoZmlsZXMsIHtcclxuICAgICAgICAgICAgICAgIGhlYWRlcjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIHdvcmtlcjp0cnVlLFxyXG4gICAgICAgICAgICAgICAgc3RlcDogZnVuY3Rpb24ocmVzdWx0cykge1xyXG4gICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBqc29uT2JqLnB1c2gocmVzdWx0cy5kYXRhWzBdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coanNvbk9iaik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwZXIgPSBNYXRoLnJvdW5kKChyb3dDb3VudCsrKS9yZWNvcmQqMTAwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbVswXS5zdHlsZS53aWR0aCA9IHBlciArICclJzsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1bMF0uaW5uZXJIVE1MID0gcGVyICsgJyUnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihwZXIgPT0gMTAwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zaG93VXBsb2FkQnRuID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIDUwMCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZWFkQ3N2LnJlYWRBc1RleHQoZmlsZXMpO1xyXG4gICAgfVxyXG59KTtcclxuXHJcbmFwcC5kaXJlY3RpdmUoJ21vZGFsJywgZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgICAgIHNjb3BlOiB7IFxyXG4gICAgICAgICAgICBmaWxlTmFtZTonPWZpbGVOYW1lJyxcclxuICAgICAgICAgICAgaGFuZGxlcjogJz1pZCdcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnLi4vdmlld3Mvc2hvd01vZGFsLmh0bWwnLFxyXG4gICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXHJcbiAgICAgICAgY29udHJvbGxlcjogZnVuY3Rpb24gKCRzY29wZSwkdGltZW91dCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuaGFuZGxlciA9ICdtb2RhbCc7IFxyXG4gICAgICAgICAgICAkc2NvcGUuc2hvd01zZyA9ZmFsc2U7XHJcbiAgICAgICAgICAgICR0aW1lb3V0KCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNob3dNc2cgPSB0cnVlO1xyXG4gICAgICAgICAgICB9LDgwMDAgKTtcclxuICAgICAgICB9LFxyXG4gICAgfTtcclxufSk7Il19
